#!/bin/sh

command -v python3 >/dev/null 2>&1 || { echo "I require python3 but it's not installed. Maybe try foodprocessor2 instead for python2 support." >&2; exit 1; }
python3 -m virtualenv | grep -q 'Usage: virtualenv.py' || { echo "I require virtualenv but it's not installed for python3. Please run pip3 install virtualenv." >&2; exit 1; }

basepath=$(dirname $(realpath $0))
fp_path=${basepath%bin}
venv_path=${fp_path}venv/bin/

if [ ! -e $venv_path ]; then
  echo "No venv directory found, installing required modules...\n\n"
  cd $fp_path
  python3 -m virtualenv venv
  ${venv_path}pip install -r requirements.txt
  echo "Installation complete, running app...\n\n"
fi

${venv_path}python3 ${fp_path}foodProcessor.py $@
